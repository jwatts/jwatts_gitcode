<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <rule>
        <name>CMIS_browseCmisSystem</name>
        <uuid>_a-0000da7f-1b5b-8000-14fc-010000010000_10257</uuid>
        <description>Browse a selected CMIS System</description>
        <parentUuid>_a-0000da4c-c8be-8000-14fc-010000010000_9157</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>=load(
			local!page:#&quot;SYSTEM_SYSRULES_pagingInfo&quot;(startIndex:1,batchSize:-1),  	  
			local!viewRecord,
			local!addFolder,
			local!addFile,
			local!folderName,
			local!isCreateFolder:false,
			local!isFolderCreated:false,
			local!isFileUploaded:false,
			local!cmiCreateFolderWriter: bind(
											null,
											#&quot;_a-0000da4d-4e53-8000-14fc-010000010000_9186&quot;(parentId:local!addFolder,properties:_,cmisName:ri!cmisName)
										 ),
			local!appianDocumentToUpload,
			local!cmiCopyDocumentFromAppianWriter: bind(
				null,
				#&quot;_a-0000da4d-4e53-8000-14fc-010000010000_9205&quot;(objectId:ri!selectedObject,file:_,cmisName:ri!cmisName)			
			  ),
			

										 
	with(
				local!res:if (isNull(ri!cmisName),null,#&quot;_a-0000da4b-7cda-8000-14fc-010000010000_9003&quot;(folderObjectId:ri!selectedObject,cmisName:ri!cmisName)),
				local!totalResults: if(isNull(local!res),0, count(local!res[&quot;cmis:objectId&quot;])),
				local!isEmpty:local!totalResults=0,
		{  
			 #&quot;SYSTEM_SYSRULES_sectionLayout&quot;(
				   label:&quot;Browsing contents &quot; &amp; if(isNull(ri!cmisName),&quot;&quot;,&quot; of &quot;&amp;ri!cmisName),

			   firstColumnContents:{
			   /*
			   a!richTextDisplayField(
				  align:&quot;LEFT&quot;,
				  value:a!richTextItem(
					text:{
						a!richTextItem(
						  text:&quot;/&quot;,
						  link:a!dynamicLink(
							value:if (isNull(ri!cmisName),&quot;&quot; ,rule!CMIS_getRootFolderId(ri!cmisName)),
							saveInto:{ ri!selectedObject, a!save(target:ri!selectedObjectBreadcrumb, value:null), a!save(target:ri!selectedObjectBreadcrumbName, value:null)} ,
							label:&quot;/&quot;
						  )
						),
						 if (OR (isNull(ri!selectedObjectBreadcrumbName), COUNT(ri!selectedObjectBreadcrumbName)=0),{},
							apply(rule!CMIS_createBreadCrumbLink(breadCrumbName:_, 
									breadCrumbValue:_, 
									saveInto:ri!selectedObject, 
									updatedObjectBreadcrumb:ri!selectedObjectBreadcrumb, 
									updatedObjectBreadcrumbName:ri!selectedObjectBreadcrumbName,
									index:_),
								merge(ri!selectedObjectBreadcrumbName, ri!selectedObjectBreadcrumb,1+enumerate(COUNT(ri!selectedObjectBreadcrumb))) 
											)
						  )
					
					}
				  )
				),
			*/
             
			  #&quot;SYSTEM_SYSRULES_ButtonArrayLayout&quot;(
				buttons:{
				  #&quot;SYSTEM_SYSRULES_ButtonWidget&quot;(
					label:&quot;/&quot;,
					style:&quot;NORMAL&quot;,
					value:if (isNull(ri!cmisName),&quot;&quot; ,#&quot;_a-0000da54-e0b0-8000-14fc-010000010000_9254&quot;(ri!cmisName)),
					saveInto:{ ri!selectedObject, a!save(target:ri!selectedObjectBreadcrumb, value:null), a!save(target:ri!selectedObjectBreadcrumbName, value:null)} ,
					disabled:false,
					submit:false
				  ),
					  if (OR (isNull(ri!selectedObjectBreadcrumbName), COUNT(ri!selectedObjectBreadcrumbName)=0),{},
						apply(#&quot;_a-0000da4b-7cda-8000-14fc-010000010000_9024&quot;(breadCrumbName:_, 
														breadCrumbValue:_, 
														saveInto:ri!selectedObject, 
														updatedObjectBreadcrumb:ri!selectedObjectBreadcrumb, 
														updatedObjectBreadcrumbName:ri!selectedObjectBreadcrumbName,
														index:_),
								merge(ri!selectedObjectBreadcrumbName, ri!selectedObjectBreadcrumb,1+enumerate(COUNT(ri!selectedObjectBreadcrumb))) 
							)
					  )
				}
			  ),		
			  
			   if(local!isEmpty,{},	
					#&quot;SYSTEM_SYSRULES_gridField&quot;(
					  label:&quot;Path: &quot; &amp; #&quot;_a-0000da4c-c8be-8000-14fc-010000010000_9099&quot;(ri!selectedObjectBreadcrumbName) ,
					  labelPosition:&quot;ABOVE&quot;,
					  totalCount:local!totalResults,
					  columns:{		
							#&quot;SYSTEM_SYSRULES_gridImageColumn&quot;(
							  label:&quot;Type&quot;,
							  field:if (local!isEmpty, {},local!res[&quot;cmis:objectTypeId&quot;]),
							  data:apply(#&quot;_a-0000da4c-0be2-8000-14fc-010000010000_9085&quot;(res:local!res, selectedObject:ri!selectedObject, selectedObjectBreadcrumb:ri!selectedObjectBreadcrumb, selectedObjectBreadcrumbName:ri!selectedObjectBreadcrumbName, index:_, cmisName:ri!cmisName), 1+enumerate(local!totalResults)),
							  size:&quot;ICON&quot;
							), 	
					  
						  #&quot;SYSTEM_SYSRULES_gridTextColumn&quot;(
							  label:&quot;Name&quot;,
							  field:&quot;name&quot;,
							  data:if (local!isEmpty, {},local!res[&quot;cmis:name&quot;]),
							  alignment:&quot;LEFT&quot;,
							  links: apply(#&quot;_a-0000da4b-7cda-8000-14fc-010000010000_9018&quot;(	linkValue:_, 
																	res:local!res, 
																	selectedObject:ri!selectedObject, 
																	selectedObjectBreadcrumb:ri!selectedObjectBreadcrumb, 
																	selectedObjectBreadcrumbName:ri!selectedObjectBreadcrumbName, 
																	linkLabel:_,
																	cmisName:ri!cmisName), 
										  merge(1+enumerate(local!totalResults),local!res[&quot;cmis:objectTypeId&quot;])
									   )
							),					 
						  #&quot;SYSTEM_SYSRULES_gridTextColumn&quot;(
						  label:&quot;Created By&quot;,	
						  field:&quot;createdBy&quot;,
						  data:if(local!isEmpty, {},local!res[&quot;cmis:createdBy&quot;]),
						  alignment:&quot;LEFT&quot;
						  ),
						  #&quot;SYSTEM_SYSRULES_gridTextColumn&quot;(
						  label:&quot;Created On&quot;,	
						  field:&quot;creationDate&quot;,
						  data:if(local!isEmpty, {},local!res[&quot;cmis:creationDate&quot;]),
						  alignment:&quot;LEFT&quot;
						  ),
						  #&quot;SYSTEM_SYSRULES_gridTextColumn&quot;(
						  label:&quot;Last modified By&quot;,	
						  field:&quot;lastModifiedBy&quot;,
						  data:if(local!isEmpty, {},local!res[&quot;cmis:lastModifiedBy&quot;]),
						  alignment:&quot;LEFT&quot;
						  ),
						  #&quot;SYSTEM_SYSRULES_gridTextColumn&quot;(
						  label:&quot;Last modified On&quot;,	
						  field:&quot;lastModificationDate&quot;,
						  data:if(local!isEmpty, {},local!res[&quot;cmis:lastModificationDate&quot;]),
						  alignment:&quot;LEFT&quot;
						  ),
						 
						  #&quot;SYSTEM_SYSRULES_gridImageColumn&quot;(
							data:apply( #&quot;SYSTEM_SYSRULES_documentImage&quot;(
										  document:#&quot;_a-0000da4c-c8be-8000-14fc-010000010000_9136&quot;[3],
										  altText:&quot;View&quot;,
										  caption:&quot;View details&quot;,
										  link:_ 
										),
									apply( #&quot;SYSTEM_SYSRULES_dynamicLink&quot;(
											  value:_,
											  saveInto:local!viewRecord,
											  label:_),
										 merge(local!res[&quot;cmis:objectId&quot;], local!res[&quot;cmis:name&quot;])	  
										 )
								),
							size:&quot;ICON&quot;							
							),
							 #&quot;SYSTEM_SYSRULES_gridTextColumn&quot;(
						  label:&quot;Version&quot;,	
						  field:&quot;versionLabel&quot;,
						  data:if(local!isEmpty, {},local!res[&quot;cmis:versionLabel&quot;]),
						  alignment:&quot;LEFT&quot;
						  ),
							 #&quot;SYSTEM_SYSRULES_gridImageColumn&quot;(
							data:apply(#&quot;_a-0000da4d-4e53-8000-14fc-010000010000_9196&quot;(objectType:_, linkValue:_, addFolder:local!addFolder, linkName:_),
							 merge( local!res[&quot;cmis:objectTypeId&quot;],local!res[&quot;cmis:objectId&quot;],local!res[&quot;cmis:name&quot;])
							),
							size:&quot;ICON&quot;							
							)
					  },
					  identifiers:1+enumerate(local!totalResults),
					  value:local!page,	
					  saveInto:local!page,
					  selection:true,
					  requireSelection:false,
					  disabled:true	
					)
				  ),
				  /*Show toolbar for various actions that can be performed  - Using Text instead of Images as */
				  if(isNull(ri!cmisName),{},
					  #&quot;SYSTEM_SYSRULES_imageField&quot;(
						label:&quot;Action&quot;,
						labelPosition:&quot;COLLAPSED&quot;,
						images:{
							#&quot;SYSTEM_SYSRULES_documentImage&quot;(
							  document:#&quot;_a-0000da56-072d-8000-14fc-010000010000_9306&quot;[1],
							  altText:&quot;Upload a file&quot;,
							  caption:&quot;Upload a file&quot;,
							  link:
								#&quot;SYSTEM_SYSRULES_dynamicLink&quot;(
								  label:&quot;Upload a file&quot;,
								  value:true,
								  saveInto:local!addFile
								) 
							),							
							#&quot;SYSTEM_SYSRULES_documentImage&quot;(
							  document:#&quot;_a-0000da56-072d-8000-14fc-010000010000_9306&quot;[2],
							  altText:&quot;Create folder&quot;,
							  caption:&quot;Create folder&quot;,
							  link:
								#&quot;SYSTEM_SYSRULES_dynamicLink&quot;(
								  label:&quot;Create folder&quot;,
								  value:If(IsNull(ri!selectedObject),#&quot;_a-0000da54-e0b0-8000-14fc-010000010000_9254&quot;(ri!cmisName) ,ri!selectedObject),
								  saveInto:local!addFolder
								) 
							)							
						},
						size:&quot;STANDARD&quot;
					  )
				   )
				 },
					isCollapsible:true
				),
				
				/*Option to Upload Document*/
				if (OR( isNull(local!addFile),isNull(ri!cmisName) ),{},
					#&quot;SYSTEM_SYSRULES_sectionLayout&quot;(
					  label:&quot;Upload Document&quot;,
					  firstColumnContents:{
					 			
						#&quot;SYSTEM_SYSRULES_imageField&quot;(
							label:if (local!isFileUploaded,&quot;Success&quot; , &quot; &quot;),
							labelPosition:&quot;ADJACENT&quot;,
							images:#&quot;SYSTEM_SYSRULES_documentImage&quot;(
							  document: if (local!isFileUploaded,#&quot;_a-0000da56-072d-8000-14fc-010000010000_9342&quot;[2] , #&quot;_a-0000da56-072d-8000-14fc-010000010000_9342&quot;[1]),
							  altText:if (local!isFileUploaded,&quot;File uploaded&quot; , &quot;Upload file&quot;),
							  caption:if (local!isFileUploaded,&quot;File uploaded&quot; , &quot;Upload file&quot;)
							),
							size:&quot;STANDARD&quot;
						  )
					  },
					  secondColumnContents:{
					   #&quot;SYSTEM_SYSRULES_pickerFieldDocuments&quot;(
							label: &quot;Select Document&quot;,
							labelPosition:&quot;ADJACENT&quot;,
							maxSelections: 1,
							value: local!appianDocumentToUpload,
							saveInto: local!appianDocumentToUpload
						  )	,
						
						  #&quot;SYSTEM_SYSRULES_ButtonLayout&quot;(
							primaryButtons:{
							  #&quot;SYSTEM_SYSRULES_ButtonWidget&quot;(
								label:&quot;Upload&quot;,
								style:&quot;PRIMARY&quot;,
								confirmMessage:&quot;Are you sure you want to upload this document?&quot;,
								value:local!appianDocumentToUpload,
								saveInto:{local!cmiCopyDocumentFromAppianWriter, a!save(target:local!isFileUploaded, value:true) },
								disabled:false,
								submit:false
							  ),
							  #&quot;SYSTEM_SYSRULES_ButtonWidget&quot;(
								label:&quot;Close&quot;,
								style:&quot;DESTRUCTIVE&quot;,
								value:null,
								saveInto:{ local!appianDocumentToUpload , local!addFile, a!save(target:local!isFileUploaded, value:false) },
								disabled:false, 
								submit:false
							  )
							}
						  )
					  },
					  isCollapsible:true
					)				
				),
				
				/*Option to create a folder */
				if (AND(isNull(local!addFolder), NOT(local!isFolderCreated)),{},
					#&quot;SYSTEM_SYSRULES_sectionLayout&quot;(
					  label:&quot;Add a folder&quot;,
					  firstColumnContents:{
						  #&quot;SYSTEM_SYSRULES_imageField&quot;(
							label:if (local!isFolderCreated,&quot;Success&quot; , &quot; &quot;),
							labelPosition:&quot;ADJACENT&quot;,
							images:#&quot;SYSTEM_SYSRULES_documentImage&quot;(
							  document: if (local!isFolderCreated,#&quot;_a-0000da4d-4e53-8000-14fc-010000010000_9203&quot;[2] , #&quot;_a-0000da4d-4e53-8000-14fc-010000010000_9203&quot;[1]),
							  altText:if (local!isFolderCreated,&quot;Folder created&quot; , &quot;Create a new folder&quot;),
							  caption:if (local!isFolderCreated,&quot;Folder created&quot; , &quot;Create a new folder&quot;)
							),
							size:&quot;STANDARD&quot;
						  )
					  },
					  secondColumnContents:{
						#&quot;SYSTEM_SYSRULES_textField&quot;(
						  label:&quot;Folder name&quot;,
						  labelPosition:&quot;ADJACENT&quot;,  
						  value:local!folderName,
						  saveInto:local!folderName,     
						  required:false,
						  readOnly:false,
						  disabled:false,
						  validations:{ if (#&quot;_a-0000da31-af1f-8000-14fc-010000010000_8924&quot;(local!folderName,1,30) ,null ,&quot;Invalid folder name&quot;)},
						  align:&quot;LEFT&quot;
						),
						
						
						#&quot;SYSTEM_SYSRULES_ButtonLayout&quot;(
						  primaryButtons:{
						  #&quot;SYSTEM_SYSRULES_ButtonWidget&quot;(
							  label:&quot;Create&quot;,
							  style:&quot;PRIMARY&quot;,
							  value:{name: local!folderName},
							  saveInto:{ local!cmiCreateFolderWriter, a!save(target:local!addFolder, value:null), a!save(target:local!isFolderCreated, value:true) },
							  disabled:isNull(local!folderName),
							  submit:false,
							  validate:false
							),
						  #&quot;SYSTEM_SYSRULES_ButtonWidget&quot;(
							  label:&quot;Close&quot;,
							  style:&quot;DESTRUCTIVE&quot;,
							  value:null,
							  saveInto:{local!folderName, a!save(target:local!isFolderCreated, value:false), a!save(target:local!addFolder, value:null) },
							  disabled:false,
							  submit:false
							)
							
						  }
						)
					  },
					  isCollapsible:true
					 ) 
				),			
				/* Show details of selected item here*/
				if (isNull(local!viewRecord),{},
				  #&quot;04104f0a-9be3-41c1-8454-0b0b47945917&quot;(viewRecord:local!viewRecord, cmisName:ri!cmisName, selectedObject:ri!selectedObject)			
				)		 			
				} 
			 )
				
		)</definition>
        <namedTypedValue>
            <name>cmisName</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedObject</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedObjectBreadcrumb</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedObjectBreadcrumbName</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>legacy</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
    </rule>
    <roleMap public="true">
        <role allowForAll="false" inherit="true" name="readers">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="true" name="authors">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="true" name="administrators">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
</contentHaul>
